{% extends 'dashboard.html' %}

{% load custom_filters %}

{% block content %}
    {% include "top_header.html" %}
    <div class="container">
        <h1>Progress for {{ character.name }}</h1>
        <form method="post">
            {% csrf_token %}
            <div>
                {% for quest in quests %}
                    <h3>{{ quest.name }}</h3>
                    <p>{{ quest.description }}</p>
                    {% if quest.queststep_set.all %}
                        <ul>
                            {% for step in quest.queststep_set.all %}
                                <li>
                                    <input type="checkbox" name="completed_{{ step.id }}" id="completed_{{ step.id }}" {% if progress_dict|get_item:step.id %}checked{% endif %}>
                                    <label for="completed_{{ step.id }}">{{ step.name }}: {{ step.description }}</label>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p>No steps available for this quest.</p>
                    {% endif %}
                {% endfor %}
            </div>
            <button type="submit" class="btn btn-primary">Save Progress</button>
        </form>
        <a href="{% url 'character_detail' character.id %}" class="btn btn-secondary">Back</a>
    </div>
{% endblock %}
